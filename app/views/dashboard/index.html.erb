<div class="row">
  <div class="col-md-12">
    <h1>Viking Store Analytics Dashboard</h1>
  </div>
</div>

<div class="row">
  <div class="col-md-5 panel">
    <h4>1. Overall Platform</h4>
    <div class="row">
      <div class="col-md-12">
        <h5>Last 7 days</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>New Users</td>
              <td>
                <%= @new_users[7] %>
              </td>
            </tr>
            <tr>
              <td>Orders</td>
              <td>
                <%= @new_orders[7] %>
              </td>
            </tr>
            <tr>
              <td>New Products</td>
              <td>
                <%= @new_products[7] %>
              </td>
            </tr>
            <tr>
              <td>Revenue</td>
              <td>
                $<%= number_with_precision(@revenue[7], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h5>Last 30 days</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>New Users</td>
              <td>
                <%= @new_users[30] %>
              </td>
            </tr>
            <tr>
              <td>Orders</td>
              <td>
                <%= @new_orders[30] %>
              </td>
            </tr>
            <tr>
              <td>New Products</td>
              <td>
                <%= @new_products[30] %>
              </td>
            </tr>
            <tr>
              <td>Revenue</td>
              <td>
                $<%= number_with_precision(@revenue[30], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <h5>Total</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>New Users</td>
              <td>
                <%= @new_users[@all_time] %>
              </td>
            </tr>
            <tr>
              <td>Orders</td>
              <td>
                <%= @new_orders[@all_time] %>
              </td>
            </tr>
            <tr>
              <td>New Products</td>
              <td>
                <%= @new_products[@all_time] %>
              </td>
            </tr>
            <tr>
              <td>Revenue</td>
              <td>
                $<%= number_with_precision(@revenue[@all_time], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div> <!--PANEL 1-->




  <div class="col-md-5 col-md-offset-1 panel">
    <h4>2. User Demographics and Behavior</h4>
    <div class="row">
      <div class="col-md-12">
        <h5>Top 3 States users live in</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <% @top_states.each do |entry| %>
              <tr>
                <td><%= entry.state_name %></td>
                <td><%= entry.users_in_state %></td>
              <tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h5>Top 3 cities users live in</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <% @top_cities.each do |entry| %>
              <tr>
                <td><%= entry.city_name %></td>
                <td><%= entry.users_in_city %></td>
              <tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h5>Top user with...</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>User</th>
              <th>Quantity</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Highest Single Order Value</td>
              <td>
                <%= @top_order.user_first_name + " " + @top_order.user_last_name %>
              </td>
              <td>
                $<%= number_with_precision(@top_order.value, :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Highest Lifetime Value</td>
              <td>
                <%= @highest_lifetime.user_first_name + " " + @highest_lifetime.user_last_name %>
              </td>
              <td>
                $<%= number_with_precision(@highest_lifetime.value, :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Highest Average Order Value</td>
              <td>
                <%= @highest_average.user_first_name + " " + @highest_average.user_last_name %>
              </td>
              <td>
                $<%= number_with_precision(@highest_average.value, :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Most Orders Placed</td>
              <td>
                <%= @most_orders.user_first_name + " " + @most_orders.user_last_name %>
              </td>
              <td>
                <%= @most_orders.orders_placed %>
              </td>

            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div> <!-- Panel 2 -->
</div>

<div class="row">
  <div class="col-md-5 panel">
    <h4>3. Order Statistics</h4>
    <div class="row">
      <div class="col-md-12">
        <h5>Last 7 days</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Number of Orders</td>
              <td>
                <%= @new_orders[7] %>
              </td>
            </tr>
            <tr>
              <td>Total Revenue</td>
              <td>
                $<%= number_with_precision(@revenue[7], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Average Order Value</td>
              <td>
                $<%= number_with_precision( @revenue[7] / @new_orders[7], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Largest Order Value</td>
              <td>
                $<%= number_with_precision( @largest_order[7], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h5>Last 30 days</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Number of Orders</td>
              <td>
                <%= @new_orders[30] %>
              </td>
            </tr>
            <tr>
              <td>Total Revenue</td>
              <td>
                $<%= number_with_precision(@revenue[30], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
               <td>Average Order Value</td>
               <td>
                $<%= number_with_precision( @revenue[30] / @new_orders[30], :precision => 2, :delimiter => ',') %>
               </td>
             </tr>
             <tr>
               <td>Largest Order Value</td>
               <td>
                $<%= number_with_precision( @largest_order[30], :precision => 2, :delimiter => ',') %>
               </td>
             </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h5>Total</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Item</th>
              <th>Data</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Number of Orders</td>
              <td>
                <%= @new_orders[@all_time] %>
              </td>
            </tr>
            <tr>
              <td>Total Revenue</td>
              <td>
                $<%= number_with_precision(@revenue[@all_time], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Average Order Value</td>
              <td>
                $<%= number_with_precision( @revenue[@all_time] / @new_orders[@all_time], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
            <tr>
              <td>Largest Order Value</td>
              <td>
                $<%= number_with_precision( @largest_order[@all_time], :precision => 2, :delimiter => ',') %>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>


  <div class="col-md-5 col-md-offset-1 panel">
    <h4>4. Time Series Data</h4>
    <div class="row">
      <div class="col-md-12">
        <h5>Orders by day</h5>
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Date</th>
              <th>Quantity</th>
              <th>Value</th>
            </tr>
          </thead>
          <tbody>
            <% @order_days.each_with_index do |entry, index| %>
              <tr>
                <td><%= (Time.now - index.day).strftime("%m/%d") %></td>
                <td><%= entry %></td>
                <td>$<%= number_with_precision( @daily_revenue[index], :precision => 2, :delimiter => ',') %></td>
              <tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h5>Orders by week</h5>
      </div>
    </div>
  </div>
</div>